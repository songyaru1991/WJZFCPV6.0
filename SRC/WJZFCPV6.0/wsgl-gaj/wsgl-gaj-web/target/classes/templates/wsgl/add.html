<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:auth="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
    <title>公安局--文书管理系统</title>
    <link rel="stylesheet" th:href="${application.basePath}+'/static/css/all.css'">
    <link rel="stylesheet" th:href="${application.basePath}+'/static/css/style05.css'">
    <link rel="stylesheet" th:href="${application.basePath}+'/static/js/layui/css/layui.css'">
    <script th:src="${application.basePath}+'/static/js/jquery.min.js'"></script>
    <script th:src="${application.basePath}+'/static/js/jquery.form.js'"></script>
    <script th:src="${application.basePath}+'/static/js/layui/layui.js'"></script>
    <script id="utilScript" th:src="${application.basePath}+'/static/js/util.js'"
            th:bashURL="${application.basePath}"></script>
    <!--[if lt IE 9]>
    <script th:src="${application.basePath}+'/static/js/foeIE8.js'"></script>
    <![endif]-->
    <script th:src="${application.basePath}+'/static/js/main_All.js'"></script>
    <script th:src="${application.basePath}+'/static/js/main_05.js'"></script>
    <script th:src="${application.basePath}+'/static/js/select2.js'"></script>
    <script th:src="${application.basePath}+'/static/js/verification.js'"></script>
    <script th:src="${application.basePath}+'/static/js/jquery.backgroundSize.js'"></script>
</head>
<body>
<form id="form" method="post" action="" enctype="multipart/form-data">
    <div class="E105_wripper jq_iframeleft">
    <div class="E105_case1">

        <div class="E105_tableCoat ">

            <div class="E105_baseInfo">
                <div class="E105_checkCoat fr    " style="margin-top: -12px;">
                    <input type="button" value="编辑文书内容" id="showWS" class="H105_search3 fl" onclick="showWSNR();">
                </div>
                <div class="E105_info  ">
                    <p>文书信息</p>
                </div>

            </div>

            <div class="P105_tableFloor">
                <table class="E105_table">
                    <tr>
                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>文书文号:</p><span class="E105_star">*</span>
                            </div>

                            <input type="text" class="E105_input  fl" name="wswh" id="wswh">
                        </td>

                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>文书标题名称:</p><span class="E105_star">*</span>
                            </div>

                            <input type="text" class="E105_input  fl" name="wsbtmc" id="wsbtmc"  onclick="toGetWsbtmc()" >
                        </td>

                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>判决类别</p>
                            </div>
                           <!-- <select name="pjlb" id="pjlb" class="E105_input  fl">
                                <option value="">请选择</option>
                                <option th:each="wsgnlbList : ${wsgnlbList}" th:text="${wsgnlbList.gnmc}" th:value="${wsgnlbList.id}">判决列表</option>
                            </select>-->
                            <input type="text" class="E105_input  fl" name="wsgnlbmc" id="wsgnlbmc"  onclick="toGetWsgnlb()" >
                        </td>

                    </tr>
                    <tr>
                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>文书年</p>
                            </div>

                            <input type="text" class="E105_input  fl" name="wsn" id="wsn" th:value="${bean.wsn}" style="cursor:not-allowed" readonly>

                        </td>
                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>填发人</p>
                            </div>

                            <input type="text" class="E105_input  fl" name="tfrxm" id="tfrxm" th:value="${bean.tfrxm}" style="cursor:not-allowed" readonly>

                        </td>
                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>填发单位</p>
                            </div>

                            <input type="text" class="E105_input  fl" name="tfdwmc" id="tfdwmc" th:value="${bean.tfdwmc}" style="cursor:not-allowed" readonly>

                        </td>
                    </tr>

                    <tr>
                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>填发时间</p>
                            </div>

                            <input type="text" class="E105_input  fl" name="tfsj" id="tfsj" th:value="${bean.tfsj}" style="cursor:not-allowed" readonly>

                        </td>
                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>修改人</p>
                            </div>

                            <input type="text" class="E105_input  fl" name="xgrxm" id="xgrxm" style="cursor:not-allowed" readonly>

                        </td>
                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>修改单位</p>
                            </div>

                            <input type="text" class="E105_input  fl" name="xgdwmc" id="xgdwmc" style="cursor:not-allowed" readonly>

                        </td>
                    </tr>
                    <tr>
                        <td class="clear">
                            <div class="E105_bianhao fl clear">
                                <p>修改时间</p>
                            </div>

                            <input type="text" class="E105_input  fl" name="xgsj" id="xgsj" style="cursor:not-allowed" readonly>

                        </td>

                    </tr>

                </table>
            </div>

            <input type="hidden" name="searchCondition" id="searchCondition" th:value="${searchCondition}"/>
            <input type="hidden" name="searchContent" id="searchContent" th:value="${searchContent}"/>
            <input type="hidden" name="pageNo" id="pageNo" th:value="${pageNo}"/>
            <input type="hidden" name="jlbh" id="jlbh" th:value="${bean.jlbh}"/>
            <input type="hidden" name="wslx" id="wslx" th:value="${bean.wslx}"/>
            <input type="hidden" name="ajbs" id="ajbs" th:value="${bean.ajbs}"/>
            <input type="hidden" name="ajbh" id="ajbh" th:value="${bean.ajbh}"/>
            <input type="hidden" name="wsmanageid" id="wsmanageid"/>
            <input type="hidden" name="pjlb" id="pjlb"/>

            <div class="S105_btnCoat1 ">
                <div class="E105_saveBtnCoat clear">
                    <div class="S105_saveBtn fl cursor"  th:onclick="saveWsgs()"><p>保存</p></div>
                    <div class="S105_saveBtn fl cursor jq_E105_cannel3"><p>返回</p></div>
                </div>
            </div>

        </div>
    </div>
</div>
</form>

<div id="popupContact" style="width: 530; height: 500px; z-index: 30; display: none;">
    <div id="contactArea">
    </div>
    <div id="contactArea1" style="display: none;">
        <iframe id="iframeWS" style="width: 500px; height: 500px; border: #000000 solid 0px;
                overflow: hidden;" scrolling="no" frameborder="0"></iframe>
    </div>
</div>

</body>
<script>
    var contextPath = getContextPath();

    saveWsgs = function (){
        var data = {
            wswh: "input NotNull", wsbtmc: "input NotNull"
        };
        var flag = V_CHECK(data);
        if (!flag) {
            return;
        }

        $.ajax({
            url: contextPath + '/Wsgl/saveAdd ',
            type:"post",
            data:$("#form").serialize(),
            dataType:"json",
            success: function (result) {
                if (result.code == 200) {
                    layer.alert(result.message, function (index) {
                        layer.close(layer.index);
                        parent.$('.src_iframeleft').attr('src', result.nextUrl);
                    });

                } else {
                    layer.alert(result.message);
                    return;
                }
            },
            error: function (result) {
                alert("error");
                $('.src_iframeleft').attr('src', result.nextUrl);
            }
        })
        return false;
    }


    layui.use(['layer'], function () {
        var layer = layui.layer;
    })

    function showWSNR() {
        var wsmanageid = $("#wsmanageid").val();
        var bookMarkKeyValue = $("#ajbs").val();
        if(wsmanageid == null || wsmanageid == ""){
            layer.alert("请先选择文书标题名称!");
            return;
        }
        $("#contactArea").html($("#contactArea1").html());
        var TemplateID = $("#jlbh").val();
        $("#iframeWS").attr("src", '../TDocEdit/TDocumentEdit?id=' + TemplateID +'&wsmanageid=' +wsmanageid + '&bookMarkKeyValue='+bookMarkKeyValue);
        resizeiframe();
        $("#popupContact").fadeIn();
    };

    function disablePopup() {

        $("#popupContact").fadeOut("slow");
    }
    function resizeiframe() {
        var windowWidth = document.documentElement.clientWidth - 1;
        var windowHeight = document.documentElement.clientHeight - 10;
        $("#iframeWS").css({
            "width": windowWidth,
            "height": windowHeight
        });
        $("#popupContact").css({
            "position": "absolute",
            "top": 0,
            "left": 0,
            "width": windowWidth,
            "height": windowHeight
        });
    }
    window.onresize = function () {
        resizeiframe();
    }

    function toGetWsbtmc(){
        layIndex = layui.layer.open({
            title: '<span>选择</span>',
            type: 2,
            shadeClose: false,
            shade: 0.6,
            skin: 'A105_layer',
            area: ['650px', '450px'], //宽高
            content: [contextPath + '/Wsgl/toGetWsbtmc', 'yes']//不允许出现滚动条
        })
    }

    function toGetWsgnlb(){
        layIndex = layui.layer.open({
            title: '<span>选择</span>',
            type: 2,
            shadeClose: false,
            shade: 0.6,
            skin: 'A105_layer',
            area: ['650px', '450px'], //宽高
            content: [contextPath + '/Wsgl/toGetWsgnlb', 'yes']//不允许出现滚动条
        })
    }

    function layerclose() {
        layer.close(layIndex);
    }


</script>
</html>